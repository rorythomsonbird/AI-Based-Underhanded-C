import GPTAPI
import os

class MalwareCheck:

    @classmethod
    def check(cls,file): #Check if malware
        filestr = cls.filetostring(file)
        
        
        return GPTAPI.GPTAPI.generate_response("In a simple yes or no answer can this code be used maliciously: \n" + filestr) #returns if the code is malicious or not
    @classmethod
    def filetostring(cls,file): #Convert the file text into a string
        with open(file) as fileOpen:
            filestr = fileOpen.read()
        return filestr

    @classmethod
    def checksamples(cls):
        dir_path = r'Samples'
        checklist = list()

        for path in os.listdir(dir_path):
            if '.obj' not in path:
                checklist.append(cls.check("Samples/"+path))
        return checklist
