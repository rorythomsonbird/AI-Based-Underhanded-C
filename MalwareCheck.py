import GPTAPI
import os

class MalwareCheck:

    @classmethod
    def check(cls,file): #Check if malware
        filestr = cls.filetostring(file)
        prompt = "Can this code be used maliciously: \n" + filestr+"\n"\
        +"Begin your response with either a yes(if the code is malicious) or a no(the code is not malicious), then proceed to explain why. "\
        +"Example: \"No. This code is simple fibonacci calculator and has no underlying malicious intent.\""
        
        return GPTAPI.GPTAPI.generate_response(prompt) #Returns if the code can be used maliciously
    @classmethod
    def filetostring(cls,file): #Convert the file text into a string
        with open(file) as fileOpen:
            filestr = fileOpen.read()
        return filestr

   